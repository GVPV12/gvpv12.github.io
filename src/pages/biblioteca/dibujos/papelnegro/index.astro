---
import BaseLayout from '../../../../layouts/BaseLayout.astro';
import { Image } from 'astro:assets';

const allImages = import.meta.glob<{ default: ImageMetadata }>('/src/assets/img/*.{jpeg,jpg,png,gif,webp}');

const galleryData = {
  title: 'Papel negro',
  slug: 'papelnegro',
  images: [
    { 
      src: '/src/assets/img/aligned.webp', 
      alt: 'Aligned', 
      externalUrl: 'https://www.instagram.com/p/ejemplo1/' 
    },
    { 
      src: '/src/assets/img/catrina.webp', 
      alt: 'Catrina', 
      externalUrl: 'https://www.instagram.com/p/ejemplo2/' 
    },
    // ... a√±ade el resto aqu√≠
  ]
};

const { title, images } = galleryData;
---

<BaseLayout title={title} description={`Galer√≠a: ${title}`}>
  <div class="container">
    <main>
      <div class="mb-8">
        <a href="/biblioteca/dibujos/" class="text-cyan-400 hover:text-cyan-300 text-sm mb-4 inline-block">‚Üê Volver a Dibujos</a>
        <h1 class="text-3xl font-bold mb-2">{title}</h1>
      </div>
      
      <div class="gallery-grid">
        {images.map(async (image) => {
          if (!allImages[image.src]) return null;
          const imageMetadata = await allImages[image.src]();

          return (
            <div class="gallery-item">
              <Image 
                src={imageMetadata.default} 
                alt={image.alt} 
                width={500} 
                height={500} 
                class="main-img"
              />
              
              <div class="overlay">
                <div class="icon-container">
                  {/* BOT√ìN LUPA: Abre el archivo de imagen en pesta√±a nueva */}
                  <a 
                    href={imageMetadata.default.src} 
                    target="_blank" 
                    rel="noopener noreferrer" 
                    class="icon-link" 
                    title="Ver imagen completa en pesta√±a nueva"
                  >
                    <span class="icon">üîç</span>
                  </a>
                  
                  {/* BOT√ìN ENLACE: Abre Instagram/Externo en pesta√±a nueva */}
                  <a 
                    href={image.externalUrl} 
                    target="_blank" 
                    rel="noopener noreferrer" 
                    class="icon-link" 
                    title="Ver publicaci√≥n original"
                  >
                    <span class="icon">üîó</span>
                  </a>
                </div>
                <span class="overlay-text">{image.alt}</span>
              </div>
            </div>
          );
        })}
      </div>
    </main>
  </div>
</BaseLayout>

<style>
  /* El CSS se mantiene igual al anterior */
  .container { max-width: 1400px; margin: 0 auto; padding: 0 1.5rem; }
  .gallery-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1.5rem; }
  .gallery-item { position: relative; aspect-ratio: 1/1; overflow: hidden; border-radius: 0.75rem; background-color: #18181b; }
  .main-img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease; }
  .overlay { position: absolute; inset: 0; background: rgba(0, 0, 0, 0.6); display: flex; flex-direction: column; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s ease; backdrop-filter: blur(2px); }
  .gallery-item:hover .overlay { opacity: 1; }
  .gallery-item:hover .main-img { transform: scale(1.1); }
  .icon-container { display: flex; gap: 1.5rem; margin-bottom: 1rem; }
  .icon-link { background: white; width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; text-decoration: none; transition: all 0.2s ease; }
  .icon-link:hover { transform: translateY(-5px); background: #22d3ee; }
  .icon { font-size: 1.5rem; }
  .overlay-text { color: white; font-weight: 600; font-size: 0.9rem; }
</style>